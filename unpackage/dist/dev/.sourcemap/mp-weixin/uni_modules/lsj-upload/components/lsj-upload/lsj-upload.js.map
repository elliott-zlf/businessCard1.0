{"version":3,"sources":["webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?77ba","webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?7b7c","webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?eb24","webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?5ba5","uni-app:///uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue","webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?c69b","webpack:////Users/elliott/Desktop/businessCard1.0/uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue?369a"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC8D;AACL;AACqC;;;AAG9F;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxBA;AAAA;AAAA;AAAA;AAAu1B,CAAgB,wyBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC6B32B;AACA;AACA,2BADA;AAEA;AACA,kBADA;AAEA,qBAFA,EAFA;;AAMA;AACA,kBADA;AAEA,sBAFA,EANA;;AAUA;AACA,kBADA;AAEA,iBAFA,EAVA;;;;;;;;;AAqBA;AACA,kBADA;AAEA,uBAFA,EArBA;;;AA0BA;AACA,kBADA;AAEA,0BAFA,EA1BA;;AA8BA,yBA9BA;AA+BA,0BA/BA;AAgCA,4BAhCA;AAiCA,2BAjCA,EADA;;AAoCA;AACA,iBADA;AAEA,kBAFA,EApCA;;AAwCA,MAxCA,kBAwCA;AACA;AACA;AACA;AACA;AACA,iBADA;AAEA,qBAFA;;AAIA,GAhDA;AAiDA;AACA,aADA,uBACA;AACA;AACA,yBADA;AAEA,2BAFA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAfA,EAjDA;;AAkEA,SAlEA,qBAkEA;;AAEA,GApEA;AAqEA;AACA,SADA,mBACA;;;;;;;;;;;;;;;;AAgBA;;AAEA,KAnBA;AAoBA,UApBA,oBAoBA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;;;;;;;AAOA,KAvEA;AAwEA,SAxEA,mBAwEA;AACA;AACA,KA1EA;AA2EA,cA3EA,sBA2EA,GA3EA,EA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAtFA;AAuFA,gBAvFA,0BAuFA;;AAEA;AACA;AACA,gBADA;AAEA,oBAFA;AAGA;AACA;AACA,SALA;AAMA;AACA;AACA,SARA;;;AAWA,KArGA;AAsGA,kBAtGA,0BAsGA,IAtGA,EAsGA;AACA,kBADA,qCACA,KADA,CACA,KADA,oCACA,KADA,uBACA,GADA,iBACA,GADA,oCACA,IADA,CACA,IADA,mCACA,MADA,2DACA,MADA,CACA,MADA,qCACA,EADA,8DACA,QADA,CACA,QADA,sCACA,EADA;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SADA;AAEA,UAFA;AAGA,eAHA;AAIA,eAJA;AAKA,4BALA;AAMA,8BANA;;;AASA;AACA;AACA;AACA;AACA,OAJA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OATA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OALA;AAMA,KAhJA;AAiJA,gBAjJA,wBAiJA,KAjJA,EAiJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAVA;AAWA,KA3KA;AA4KA,iBA5KA,2BA4KA;AACA;AACA;AACA;AACA,iCADA;AAEA,mCAFA;;;;;;;AASA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;AASA,gCATA,CAEA,MAFA,qBAEA,MAFA,2CAGA,OAHA,CAGA,OAHA,sCAGA,EAHA,mEAIA,GAJA,CAIA,GAJA,sCAIA,EAJA,mEAKA,QALA,CAKA,QALA,sCAKA,EALA,mEAMA,YANA,CAMA,YANA,sCAMA,IANA,mEAOA,OAPA,CAOA,OAPA,sCAOA,KAPA,mEAQA,MARA,CAQA,MARA,sCAQA,CARA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAbA;;AAeA,OAzBA;AA0BA,KAxNA;AAyNA,YAzNA,oBAyNA,IAzNA,SAyNA;AACA;AACA;AACA;AACA,SADA;AAEA,UAFA;AAGA,eAHA;AAIA,eAJA;AAKA,4BALA;AAMA,0BANA;;;AASA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OARA,EAQA,KARA;AASA;AACA;AACA;AACA;AACA;AACA,OALA;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAJA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,OAfA;AAgBA;AACA;AACA,KA9QA,EArEA,E;;;;;;;;;;;;;AC7BA;AAAA;AAAA;AAAA;AAAkuC,CAAgB,6nCAAG,EAAC,C;;;;;;;;;;;ACAtvC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"uni_modules/lsj-upload/components/lsj-upload/lsj-upload.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./lsj-upload.vue?vue&type=template&id=8724a0b6&scoped=true&\"\nvar renderjs\nimport script from \"./lsj-upload.vue?vue&type=script&lang=js&\"\nexport * from \"./lsj-upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./lsj-upload.vue?vue&type=style&index=0&id=8724a0b6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8724a0b6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"uni_modules/lsj-upload/components/lsj-upload/lsj-upload.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./lsj-upload.vue?vue&type=template&id=8724a0b6&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var s0 = _vm.__get_style([_vm.getStyles])\n\n  var s1 = _vm.__get_style([_vm.getStyles])\n\n  var s2 = _vm.__get_style([_vm.getStyles])\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        s0: s0,\n        s1: s1,\n        s2: s2\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./lsj-upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./lsj-upload.vue?vue&type=script&lang=js&\"","<template>\n\t<view class=\"lsj-file\" ref=\"lsjFile\" :style=\"[getStyles]\">\r\n\t\t<!-- #ifdef APP-PLUS -->\r\n\t\t<view>\r\n\t\t\t<slot>\r\n\t\t\t\t<view class=\"defview\" :style=\"[getStyles]\">附件上传</view>\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t\r\n\t\t<!-- #ifdef H5 -->\r\n\t\t<view class=\"hFile\" ref=\"hFile\" :style=\"[getStyles]\">\r\n\t\t\t<slot>\r\n\t\t\t\t<view class=\"defview\" :style=\"[getStyles]\">附件上传</view>\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t\r\n\t\t<!-- #ifdef MP-WEIXIN -->\r\n\t\t<view class=\"hFile\" @click=\"wxChooseFile\" :style=\"[getStyles]\">\r\n\t\t\t<slot>\r\n\t\t\t\t<view class=\"defview\" :style=\"[getStyles]\">附件上传</view>\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\n\t</view>\n</template>\n\n<script>\n\texport default {\r\n\t\tprops: {\r\n\t\t\tvalue: [String,Number],\r\n\t\t\twidth: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '100%'\r\n\t\t\t},\r\n\t\t\theight: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '80rpx'\r\n\t\t\t},\r\n\t\t\tsize: {\r\n\t\t\t\ttype: Number,\r\n\t\t\t\tdefault: 10\r\n\t\t\t},\r\n\t\t\t// #ifdef APP-NVUE\r\n\t\t\tposition: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'absolute'\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\t// #ifndef APP-NVUE\r\n\t\t\tposition: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'static'\r\n\t\t\t},\r\n\t\t\t// #endif\r\n\t\t\tchildId: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'lsjUpload'\r\n\t\t\t},\r\n\t\t\ttop: [String,Number],\r\n\t\t\tleft: [String,Number], \r\n\t\t\tbottom: [String,Number], \r\n\t\t\tright: [String,Number], \r\n\t\t},\r\n\t\tmodel: {\r\n\t\t\tprop: 'value',\r\n\t\t\tevent: 'input'\r\n\t\t},\n\t\tdata() {\r\n\t\t\tthis.xmlRequest = '';\r\n\t\t\tthis.wxParam = {};\r\n\t\t\tthis.wv = {};\n\t\t\treturn {\n\t\t\t\tfileDom: '',\r\n\t\t\t\tdisabled: false\n\t\t\t}\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tgetStyles() {\r\n\t\t\t\tlet styles = {\r\n\t\t\t\t\twidth: this.width,\r\n\t\t\t\t\theight: this.height,\r\n\t\t\t\t};\r\n\t\t\t\tif (this.position == 'absolute') {\r\n\t\t\t\t\tstyles['top'] = this.top;\r\n\t\t\t\t\tstyles['bottom'] = this.bottom;\r\n\t\t\t\t\tstyles['left'] = this.left;\r\n\t\t\t\t\tstyles['right'] = this.right;\r\n\t\t\t\t\tstyles['position'] = 'fixed';\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn styles\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tclose() {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tif (plus.webview.getWebviewById(this.childId)) {\r\n\t\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\t\tthis.wv.removeFromParent();\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\tplus.webview.close(this.childId,\"none\",0);\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\tif (this.fileDom) {\r\n\t\t\t\t\tthis.$refs.hFile.$el.removeChild(this.fileDom);\r\n\t\t\t\t\tthis.fileDom = '';\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tthis.disabled = true;\r\n\t\t\t\t// #endif\r\n\t\t\t},\n\t\t\tcreate(param = {}) {\r\n\t\t\t\tif (!param.url) {console.error('url为必传参数');return;}\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t\tif (!param.cuWebview) {console.error('cuWebview为必传参数');return;}\r\n\t\t\t\t\tthis.close();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// #ifndef APP-NVUE\r\n\t\t\t\t\tlet view = uni.createSelectorQuery().in(this).select(\".lsj-file\");\r\n\t\t\t\t\tview.fields({\r\n\t\t\t\t\t  size: true,\r\n\t\t\t\t\t  rect: true,\r\n\t\t\t\t\t}, ({height,width,top,left,right,bottom}) => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.createSelectorQuery().selectViewport().scrollOffset(({scrollTop}) => {\r\n\t\t\t\t\t\t\tthis.createAppFile({\r\n\t\t\t\t\t\t\t\ttop: (parseInt(top) + parseInt(scrollTop)) + 'px',\r\n\t\t\t\t\t\t\t\tleft: parseInt(left) + 'px',\r\n\t\t\t\t\t\t\t\twidth: parseInt(width) + 'px',\r\n\t\t\t\t\t\t\t\theight: parseInt(height) + 'px',\r\n\t\t\t\t\t\t\t},param);\r\n\t\t\t\t\t\t}).exec();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}).exec();\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\t\t\tconst dom = weex.requireModule('dom');\r\n\t\t\t\t\t\tdom.getComponentRect(this.$refs.lsjFile, ({size:{height,width,top,left,right,bottom}}) => {\r\n\t\t\t\t\t\t\tthis.createAppFile({\r\n\t\t\t\t\t\t\t\ttop: parseInt(top) + 'px',\r\n\t\t\t\t\t\t\t\tleft: parseInt(left) + 'px',\r\n\t\t\t\t\t\t\t\twidth: parseInt(width) + 'px',\r\n\t\t\t\t\t\t\t\theight: parseInt(height) + 'px',\r\n\t\t\t\t\t\t\t\tright: parseInt(right) + 'px',\r\n\t\t\t\t\t\t\t\tbottom: parseInt(bottom) + 'px',\r\n\t\t\t\t\t\t\t},param);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\tconsole.log('微信小程序');\r\n\t\t\t\t\tthis.wxParam = param;\r\n\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\t\tconsole.log('H5');\r\n\t\t\t\t\tthis.createH5File(param);\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\ttoast(title = '',{ duration = 2000, icon = 'none'} = {}) {\r\n\t\t\t\tuni.showToast({title,duration,icon});\r\n\t\t\t},\r\n\t\t\tgetRequest(url) {  \r\n\t\t\t\tlet theRequest = new Object(); \r\n\t\t\t\tlet index = url.indexOf(\"?\");\r\n\t\t\t\tif (index != -1) {  \r\n\t\t\t\t\tlet str = url.substring(index+1);  \r\n\t\t\t\t\tlet strs = str.split(\"&\");  \r\n\t\t\t\t\tfor(let i = 0; i < strs.length; i ++) {  \r\n\t\t\t\t\t\ttheRequest[strs[i].split(\"=\")[0]]=unescape(strs[i].split(\"=\")[1]);  \r\n\t\t\t\t\t} \r\n\t\t\t\t}  \r\n\t\t\t\treturn theRequest;  \r\n\t\t\t},\r\n\t\t\twxChooseFile() {\r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\tif (this.disabled) {return;}\r\n\t\t\t\twx.chooseMessageFile({\r\n\t\t\t\t\tcount: 1,\r\n\t\t\t\t\ttype: 'file',\r\n\t\t\t\t\tsuccess: ({tempFiles}) => {\r\n\t\t\t\t\t\tthis.handleWXUpload(tempFiles[0]);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\tthis.$emit('callback',{success: false,status: -100,msg:'文件选择失败'});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\thandleWXUpload(file) {\r\n\t\t\t\tlet {debug = false,url,name = 'file',header = {},formData = {}} = this.wxParam;\r\n\t\t\t\tif (!url) {console.error('url为必传参数');return;}\r\n\t\t\t\tif(file.size > (1024*1024 * Math.abs(this.size))) {\r\n\t\t\t\t\tthis.toast(`附件大小请勿超过${this.size}M`);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tformData['fileName'] = file.name;\r\n\t\t\t\tlet opt = {url,name,header,formData,filePath:file.path};\r\n\t\t\t\tdebug && console.log(`\r\n\t\t\t\t上传接口地址:${url}\\n\r\n\t\t\t\t附件key:${name}\\n \r\n\t\t\t\t附件名称:${file.name}\\n \r\n\t\t\t\t附件大小:${file.size}\\n\r\n\t\t\t\t请求头:${JSON.stringify(header)}\\n\r\n\t\t\t\t参数:${JSON.stringify(formData)}\r\n\t\t\t\t`);\r\n\t\t\t\t\r\n\t\t\t\topt['fail'] = ({errMsg=''}) => {\r\n\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\tconsole.error('--ERROR--：'+errMsg);\r\n\t\t\t\t\tthis.$emit('callback',{success: false,status: 500,msg:'上传失败'});\r\n\t\t\t\t};\r\n\t\t\t\topt['success'] = (res) => {\r\n\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\tif (res.statusCode==200) {\r\n\t\t\t\t\t\tdebug&&console.log('上传完成');\r\n\t\t\t\t\t\tthis.$emit('callback',{success: true,fileName:file.name,responseText: res.data,status: res.statusCode,msg:'上传成功'});\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.error('--ERROR--：status = '+res.statusCode);\r\n\t\t\t\t\tthis.$emit('callback',{success: false,status: res.statusCode,msg:'上传失败'});\r\n\t\t\t\t};\r\n\t\t\t\tthis.disabled = true;\r\n\t\t\t\tthis.xmlRequest = uni.uploadFile(opt);\r\n\t\t\t\tthis.xmlRequest&&this.xmlRequest.onProgressUpdate(({progress = 0}) => {\r\n\t\t\t\t\tif (progress <= 100) {\r\n\t\t\t\t\t\tthis.$emit('input',progress);\r\n\t\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcreateH5File(param) {\r\n\t\t\t\tthis.close();\r\n\t\t\t\tthis.fileDom = document.createElement('input');\r\n\t\t\t\tthis.fileDom.type = 'file';\r\n\t\t\t\tthis.fileDom.value = '';\r\n\t\t\t\tthis.fileDom.style.height = this.height;\r\n\t\t\t\tthis.fileDom.style.width = this.width;\r\n\t\t\t\tthis.fileDom.style.position = \"absolute\";\r\n\t\t\t\tthis.fileDom.style.top = 0;\r\n\t\t\t\tthis.fileDom.style.left = 0;\r\n\t\t\t\tthis.fileDom.style.right = 0;\r\n\t\t\t\tthis.fileDom.style.bottom = 0;\r\n\t\t\t\tthis.fileDom.style.opacity = 0;\r\n\t\t\t\tthis.fileDom.style.zIndex = 999;\r\n\t\t\t\tthis.$refs.hFile.$el.appendChild(this.fileDom);\r\n\t\t\t\tthis.fileDom.onchange = (event) => {\r\n\t\t\t\t\tlet file = event.target.files[0];\r\n\t\t\t\t\tif (file) {\r\n\t\t\t\t\t\t// 限制文件小于10M,可自行修改\r\n\t\t\t\t\t\tif(file.size > (1024*1024 * Math.abs(this.size))) {\r\n\t\t\t\t\t\t\tthis.toast(`附件大小请勿超过${this.size}M`);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.uploadH5(file,param);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreateAppFile(rect = {},{cuWebview,...param}) {\r\n\t\t\t\tparam.size = this.size;\r\n\t\t\t\tlet wvPath = '/uni_modules/lsj-upload/hybrid/html/uploadFile.html';\r\n\t\t\t\tlet styles = {\r\n\t\t\t\t\t'position': this.position,\r\n\t\t\t\t\t'background': 'transparent',\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t// #ifdef APP-NVUE\r\n\t\t\t\tstyles.position = 'absolute';\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t\tstyles = Object.assign(rect,styles);\r\n\t\t\t\t\r\n\t\t\t\tlet wv = plus.webview.create(wvPath,this.childId,styles,param || {});\r\n\t\t\t\twv.loadURL(wvPath);\r\n\t\t\t\tcuWebview.append(wv);\r\n\t\t\t\tthis.wv = wv;\r\n\t\t\t\twv.overrideUrlLoading({mode:'reject'},(e)=>{\r\n\t\t\t\t\tlet {\r\n\t\t\t\t\t\tretype,\r\n\t\t\t\t\t\tpercent = '',\r\n\t\t\t\t\t\tmsg = '',\r\n\t\t\t\t\t\tfileName = '',\r\n\t\t\t\t\t\tresponseText = '{}',\r\n\t\t\t\t\t\tsuccess = false,\r\n\t\t\t\t\t\tstatus = 0,\r\n\t\t\t\t\t} = this.getRequest(e.url);\r\n\t\t\t\t\tswitch (retype){\r\n\t\t\t\t\t\tcase 'percent':\r\n\t\t\t\t\t\t\tpercent = unescape(percent); \r\n\t\t\t\t\t\t\tthis.$emit('input',percent);\r\n\t\t\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'complete':\r\n\t\t\t\t\t\t\tmsg = unescape(msg);\r\n\t\t\t\t\t\t\tfileName = unescape(fileName);\r\n\t\t\t\t\t\t\tresponseText = unescape(responseText);\r\n\t\t\t\t\t\t\tthis.$emit('callback',{success,fileName,status,responseText,msg});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tuploadH5(file,{debug = false,url,name = 'file',method = 'POST',header = {},formData:data = {}}) {\r\n\t\t\t\tif (!url) {console.error('url为必传参数');return;}\r\n\t\t\t\tdata['fileName'] = file.name;\r\n\t\t\t\tdebug && console.log(`\r\n\t\t\t\t上传接口地址:${url}\\n\r\n\t\t\t\t附件key:${name}\\n \r\n\t\t\t\t附件名称:${file.name}\\n \r\n\t\t\t\t附件大小:${file.size}\\n\r\n\t\t\t\t请求头:${JSON.stringify(header)}\\n\r\n\t\t\t\t参数:${JSON.stringify(data)}\r\n\t\t\t\t`);\r\n\t\t\t\t\r\n\t\t\t\tlet formData = new FormData();\r\n\t\t\t\tfor (let keys in data) {formData.append(keys, data[keys]);}\r\n\t\t\t\tformData.append(name, file);\r\n\t\t\t\tthis.xmlRequest = new XMLHttpRequest();\r\n\t\t\t\tthis.xmlRequest.open(method, url, true);\r\n\t\t\t\tfor (let keys in header) {this.xmlRequest.setRequestHeader(keys, header[keys]);}\r\n\t\t\t\t\r\n\t\t\t\tthis.xmlRequest.upload.addEventListener(\"progress\",(event) => {\r\n\t\t\t\t\tif(event.lengthComputable){\r\n\t\t\t\t\t\tlet percent = Math.ceil(event.loaded * 100 / event.total);\r\n\t\t\t\t\t\tif (percent <= 100) {\r\n\t\t\t\t\t\t\tthis.$emit('input',percent);\r\n\t\t\t\t\t\t\tthis.$forceUpdate();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, false);\r\n\t\t\t\tthis.xmlRequest.ontimeout = () => {\r\n\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\tthis.fileDom.value = '';\r\n\t\t\t\t\tconsole.error('请求超时');\r\n\t\t\t\t\tthis.$emit('callback',{success: false,status: 408,msg:'请求超时'});\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tthis.xmlRequest.onreadystatechange = (ev) => {\r\n\t\t\t\t\tif(this.xmlRequest.readyState == 4) {\r\n\t\t\t\t\t\tthis.disabled = false;\r\n\t\t\t\t\t\tthis.fileDom.value = '';\r\n\t\t\t\t\t\tif (this.xmlRequest.status == 200) {\r\n\t\t\t\t\t\t\tdebug&&console.log('上传完成：'+this.xmlRequest.responseText);\r\n\t\t\t\t\t\t\tthis.$emit('callback',{success: true,fileName:file.name,responseText: this.xmlRequest.responseText,status: this.xmlRequest.status,msg:'上传成功'});\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (this.xmlRequest.status == 0) {\r\n\t\t\t\t\t\t\tconsole.error('status = 0 :请检查请求头Content-Type与服务端是否匹配，服务端已正确开启跨域，并且nginx未拦截阻止请求');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.error('--ERROR--：status = '+this.xmlRequest.status);\r\n\t\t\t\t\t\tthis.$emit('callback',{success: false,status: this.xmlRequest.status,msg:'上传失败'});\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tthis.disabled = true;\r\n\t\t\t\tthis.xmlRequest.send(formData);\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style scoped>\n.lsj-file {\r\n\tdisplay: inline-block;\r\n}\r\n.defview {\r\n\tbackground-color: #007AFF;\r\n\tcolor: #fff;\r\n\tborder-radius: 10rpx;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tfont-size: 28rpx;\r\n}\r\n.hFile {\r\n\tposition: relative;\r\n}\r\n</style>\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./lsj-upload.vue?vue&type=style&index=0&id=8724a0b6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./lsj-upload.vue?vue&type=style&index=0&id=8724a0b6&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1633598251579\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}